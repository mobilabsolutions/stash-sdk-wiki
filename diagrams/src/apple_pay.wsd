@startuml apple_pay

!include ../skin.wsd

title Apple Pay

actor "Customer / SDK" as User
entity "Merchant Backend" as MEC
control "MobiLab Backend" as MBE
entity "Payment Provider (PSP)" as PSP

User -> MEC: Checkout (Token (Pay Token))
MEC -> MBE: Authorize(xâ‚¬, "Reason", Token, PurchaseId)
MBE -> PSP: Authorize(xâ‚¬, "Reason", Token)
PSP -> MBE: Result
MBE -> MEC: Result + TransactionId
MEC -> User: Result

MBE -> PSP: Capture Payment (after 20 min)

@enduml